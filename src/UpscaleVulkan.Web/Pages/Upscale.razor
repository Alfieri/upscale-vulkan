@page "/upscale"
@using UpscaleVulkan.Application.Services
@using UpscaleVulkan.Core
@using UpscaleVulkan.Core.Settings
@inject ISettingsService settingsService
@inject IUpscaleService upscaleService

@if (string.IsNullOrEmpty(this.upscaleSettings.VideoFile))
{
    <div class="alert alert-danger" role="alert">
        Please go to settings and choose a file
    </div>
}
else
{
    <h5>Upscale video @this.upscaleSettings.VideoFile</h5>
    <VideoInfo Video="@video"/>
    <button type="button" class="btn btn-primary" @onclick="StartUpscaling">Start Upscale</button>
}

@code {
    private UpscaleSettings upscaleSettings { get; set; } = new();

    private Video video { get; set; }

    protected override async Task OnInitializedAsync()
    {
        this.upscaleSettings = await this.settingsService.LoadSettingsAsync<UpscaleSettings>();
        this.video = new Video(this.upscaleSettings.VideoFile);
    }

    private async Task StartUpscaling()
    {
        await this.upscaleService.Upscale(this.video);
    }

}