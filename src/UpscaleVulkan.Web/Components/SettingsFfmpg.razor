@using UpscaleVulkan.Core.Settings
@using UpscaleVulkan.Application.Services
@inherits ComponentBase
@inject ISettingsService settingsService;

<EditForm Model="@settings" OnSubmit="@SaveSettings">
  <div class="card">
    <div class="card-header">
      FFMpeg Settings
    </div>
    <div class="card-body">
      <h5 class="card-title">FFMpeg Settings</h5>
      <form>
        <div class="form-group">
          <label>FFMpeg binary Path</label>
          <InputText class="form-control" @bind-Value="settings.FfmpegBin" />
        </div>
        <div class="form-group">
          <label>FFProbe binary Path</label>
          <InputText class="form-control" @bind-Value="settings.FfprobBin" />
        </div>
        <div class="form-group">
          <label>Framerate</label>
          <InputText class="form-control" @bind-Value="settings.Framerate" />
        </div>
        <div class="form-group">
          <label>HW Acceleration</label>
          <InputText class="form-control" @bind-Value="settings.HardwareAcceleration" />
        </div>
        <div class="form-group">
          <label>Video Codec</label>
          <InputText class="form-control" @bind-Value="settings.Codec" />
        </div>
        <div class="form-group">
          <label>Preset</label>
          <InputText class="form-control" @bind-Value="settings.Preset" />
        </div>
        <div class="form-group">
          <label>Additional Video Codec Parameter</label>
          <InputText class="form-control" @bind-Value="settings.AdditionalCodecParameter" />
        </div>
        <div class="form-group">
          <label>Intermediate Video file name</label>
          <InputText class="form-control" @bind-Value="settings.IntermediateVideoFile" />
        </div>
        <div class="form-group">
          <label>Frames Pixel Format</label>
          <InputText class="form-control" @bind-Value="settings.VideoToFramesPixFormat" />
        </div>
        <div class="form-group">
          <label>Video Pixel Format</label>
          <InputText class="form-control" @bind-Value="settings.FramesToVideoPixFormat" />
        </div>
        <div class="form-group">
          <label>Concat Parameters</label>
          <InputText class="form-control" @bind-Value="settings.ConcatVideosParameter" />
        </div>
      </form>
      <button class="btn btn-primary" type="submit">Save</button>
    </div>
  </div>
</EditForm>

@code {
  private FfmpegSettings settings = new();

  protected override async Task OnInitializedAsync()
  {
    this.settings = await this.settingsService.LoadSettingsAsync<FfmpegSettings>();
  }

  private async Task SaveSettings()
  {
    await this.settingsService.SaveSettingsAsync(this.settings);
  }

}